import{r as l,l as N,f as v,c as n,a as e,n as k,g as y,b as g,y as R,F as U,z,t as d,d as c,v as w,i as C,j as S,w as B,m as D,k as T,o as i}from"./app-CpCrk5cI.js";import{p as q}from"./index-C89UBU5T.js";import{f as j}from"./index-VaZfHV7P.js";/* empty css            */import"./index-DyeTRx0b.js";import"./index-BRVyLNfZ.js";const F={class:k("fixed z-10 inset-0 overflow-y-auto "),"aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},I={class:"bg-white px-4 pt-5 sm:p-6"},O={class:"grid grid-cols-2 gap-6"},P=["value"],E={key:0,class:"text-red-600 text-xs text-right block"},L={key:0,class:"text-red-600 text-xs text-right block"},A={key:0,class:"text-red-600 text-xs text-right block"},G={class:"col-span-full"},H={key:0,class:"text-red-600 text-xs text-right block"},J={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},et={__name:"edit",setup(K){const u=l(null),m=l(!1),h=l(!1),x=l(!1),s=l({}),_=D(),a=l({date:"",time:"",notes:"",patient_id:""}),$=l([]),b=()=>{m.value=!1,setTimeout(()=>{window.history.back()},300)},M=async()=>{var r;s.value={},x.value=!0;try{const{data:t}=await v.patch(`/api/appointments/${u.value}`,a.value);bus.$emit("flash-message",{text:t.message,type:"success"}),bus.$emit("appointment-changed","true"),b()}catch(t){((r=t.response)==null?void 0:r.status)===422&&(s.value=t.response.data.errors)}finally{x.value=!1}};return N(async()=>{u.value=_.params.id,h.value=_.query.isPast;const r=await v.get("/api/patients/dropdown");$.value=r.data;const p=(await v.get(`/api/appointments/${u.value}`)).data,f=q(p.date);a.value={...p,date:j(f,{representation:"date"}),time:j(f,{representation:"time"}).split("T")[1]},setTimeout(()=>{m.value=!0},50)}),(r,t)=>{const p=T("c-async-button"),f=T("router-link");return i(),n("div",F,[e("form",{class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",onSubmit:t[6]||(t[6]=B(o=>M(),["prevent"]))},[e("div",{class:k(`fixed inset-0 bg-gray-500 transition-opacity duration-200 ${m.value?"bg-opacity-75":"bg-opacity-0"}`),"aria-hidden":"true",onClick:t[0]||(t[0]=o=>b())},null,2),t[15]||(t[15]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",{class:k(`inline-block w-full align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-xl sm:w-full duration-200  ${m.value?"scale-100":"scale-0"}`)},[t[14]||(t[14]=e("div",{class:"bg-gray-50 px-4 py-2 border-b border-gray-300 text-right"},[e("h3",{class:"text-lg text-gray-700 font-normal"},[y("تعديل بيانات الموعد "),e("b",{class:"font-bold"})])],-1)),e("div",I,[e("div",O,[e("div",null,[t[8]||(t[8]=e("label",{for:"patient_id",class:"block text-sm font-medium text-gray-700 text-right"},"المريض",-1)),g(e("select",{id:"patient_id","onUpdate:modelValue":t[1]||(t[1]=o=>a.value.patient_id=o),autocomplete:"off",class:"block border border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 mt-1 px-2 py-2 rounded-md shadow-sm sm:text-sm w-full"},[t[7]||(t[7]=e("option",{value:""},"اختر مريض",-1)),(i(!0),n(U,null,z($.value,(o,V)=>(i(),n("option",{key:V,value:V},d(o),9,P))),128))],512),[[R,a.value.patient_id]]),s.value&&s.value.patient_id?(i(),n("small",E,d(s.value.patient_id[0]),1)):c("",!0)]),e("div",null,[t[9]||(t[9]=e("label",{for:"date",class:"block text-sm font-medium text-gray-700 text-right"},"تاريخ الزيارة",-1)),g(e("input",{id:"date","onUpdate:modelValue":t[2]||(t[2]=o=>a.value.date=o),type:"date",autocomplete:"off",class:"block border border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 mt-1 px-2 py-2 rounded-md shadow-sm sm:text-sm w-full"},null,512),[[w,a.value.date]]),s.value&&s.value.date?(i(),n("small",L,d(s.value.date[0]),1)):c("",!0)]),e("div",null,[t[10]||(t[10]=e("label",{for:"time",class:"block text-sm font-medium text-gray-700 text-right"},"وقت الزيارة",-1)),g(e("input",{id:"time","onUpdate:modelValue":t[3]||(t[3]=o=>a.value.time=o),type:"time",autocomplete:"off",class:"block border border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 mt-1 px-2 py-2 rounded-md shadow-sm sm:text-sm w-full"},null,512),[[w,a.value.time]]),s.value&&s.value.time?(i(),n("small",A,d(s.value.time[0]),1)):c("",!0)]),e("div",G,[t[11]||(t[11]=e("label",{for:"notes",class:"block text-sm font-medium text-gray-700 text-right"},"الملاحظات",-1)),g(e("textarea",{id:"notes","onUpdate:modelValue":t[4]||(t[4]=o=>a.value.notes=o),autocomplete:"off",class:"block border border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 mt-1 px-2 py-2 rounded-md shadow-sm sm:text-sm w-full"},null,512),[[w,a.value.notes]]),s.value&&s.value.notes?(i(),n("small",H,d(s.value.notes[0]),1)):c("",!0)])])]),e("div",J,[e("button",{type:"button",class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:t[5]||(t[5]=o=>b())}," إلغاء "),C(p,{type:"submit",disabled:h.value,loading:x.value,class:"w-full inline-flex justify-center rounded-md border border-transparent transition duration-75 transition-all shadow-sm px-4 py-2 bg-teal-600 text-base font-medium text-white hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:ml-3 sm:w-auto sm:text-sm"},{default:S(()=>t[12]||(t[12]=[y(" حفظ ")]),void 0),_:1},8,["disabled","loading"]),C(f,{to:{name:"appointments-delete",params:{id:u.value},query:{type:"موعد"}},class:"mr-auto w-32 text-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:text-sm"},{default:S(()=>t[13]||(t[13]=[y(" حذف ")]),void 0),_:1},8,["to"])])],2)],32)])}}};export{et as default};
